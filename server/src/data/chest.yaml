name: first-story
intro: You wake up in a strange room. The door is locked.
  You don't remember how you got in here but just know you have to get out!

rooms:
  - name: lobby
    look: A large empty room with a table.
      There is a note on the table.
      On the floor is a large chest.
    hints:
      - 1. Have a `look` around for anything interesting!
      - 2. Try reading the note
      - 3. Does the note help you open the lock?
      - 4. What's inside the chest?
      - 5. Where could you use that key?
    examine: The door is locked
    items:

    - name: table
      description: A wooden table
      states:
        - name: default
          examine: An old wooden table. Nothing that interesting.

    - name: note
      description: A simple note
      states:
        - name: default
          examine: There seem to be a sequence of numbers written down
          image: https://images.techhive.com/images/article/2015/04/ransomnote-100581578-large.jpg
        - name: read
          examine: "You've seen it before. The numbers are starting back at you: 4 3 2 1"
      actions:
        - match: get|take
          pass:
            text: You pick up the note
            gets: note
            hintStep: 2
        - match: read|examine
          needs: false
          pass:
            text: "The note just has 4 numbers on it: 4 3 2 1.
              It seems like some kind of combination"
            gets: combination
            hintStep: 3
            updates:
              - read note

    - name: lock
      description: A rusty combination lock
      state: locked
      # image: lock.gif
      states:
        - name: locked
          examine: A strange looking combination lock. It seems you can select some numbers on it.
        - name: unlocked
          examine: you opened the lock!
      actions:
        - match: open
          needs: combination
          fail:
            text: You try to open the lock, but you don't know the combination
            hintStep: 3
          pass:
            text: you turn the dial to 4321 and it opens!
            gets: open-lock
            hintStep: 4
            updates:
              - open chest
              - open lock

    - name: chest
      description: A large treasure chest
      state: locked
      states:
        - name: locked
          examine: The chest is locked
        - name: open
          examine: the chest is open and you can see a large key inside
        - name: empty
          examine: A large chest. It's open, and there's nothing inside
      actions:
        - match: open
          needs: open-lock
          pass:
            text: You open up the chest, there's a key inside.
            updates:
              - open chest
          fail:
            text: You try to open the chest, but it's locked.

    - name: key
      description: An antique looking key
      states:
        - name: default
          examine: ...
        - name: holding-key
          examine: The key looks like it could open a door somewhere...
      actions:
        - match: open door with key|open door
          needs: key
          pass:
            text: You open up the chest, there's a key inside.
          fail:
            text: You try to open the chest, but it's locked.
        - match: get|take
          needs: open-chest
          pass:
            text: You take the key
            gets: key
          fail:
            text: You try to open the chest, but it's locked.

    - name: door
      description: A heavy door
      states:
        - name: locked
          examine: The door is locked.
        - name: unlocked
          examine: the door is unlocked.

      examine: The lock is creaking
      actions:
        - match: open
          needs: key
          fail:
            text: You try to open the door, but it's locked. If only you had a key...
          pass:
            text: You put the key in the door and it opens! You're free!
