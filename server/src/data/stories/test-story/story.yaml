name: test story
intro: You wake up in a strange room. The door is locked.
  You don't remember how you got in here but just know you have to get out!

rooms:
  - name: office
    description: A large empty room with a corner `desk`
    imageUrl: rooms/office-chest-closed.jpg
    caption: "<https://cbg.rik.ai/rooms/office| :mag: corner office>"
    setHint: start

    hints:
      start: Have a `look` around for anything interesting!
      read-note: read the note
      open-lock: try opening the lock with what you read
      open-chest: What's inside the chest?
      use-key: Where could you use that key?

      actions:
      - match: atov/i
        pass:
          text: You say ATOV to noone in particular. Maybe you need to look for something else?

    actors:
      - name: Sid
        greeting: Hey this is Sid!
        description: Sid is a happy coder
        prefix: Sid says
        states:
          - name: default
            imageUrl: actors/sid-sm.png
            short: Sid is a junior programmer
            long:
              Sid hasn't been working here very long, so he's not jaded yet.
              He's learning the basics but keeps making careless little mistakes.
              One more and he could lose his job...
          - name: angry
            short: Sid looks angry
            long: Seems like you pissed him off.

        defaultReplies:
          - Sorry I don't understand
          - what?
          - Hmm, dunno.
        actions:
          - match: greet
            pass:
              text: Welcome! Nice to see you too.
              gets: coin  # TODO
              hintStep: 2
          - match: talk
            reply: Hey, how are you!
          - match: about note
            reply: It's a weird looking memo written there, looks like a combination or something.
          - match: about chest
            reply: It's always been there... not sure where it came from.
          - match: hi|hello|what's up
            reply: Hi back!
          - match: test
            reply: Testing back!
          - match: give note
            reply: Hmm, you found my written down password! I feel bad now!
          - match: password
            reply: I'm not telling you!
          - match: how are you
            reply: I'm doing great thanks
          - match: note
            reply: Hmm it looks like a combination or a PIN code
          - match: chest
            reply: It's always been here
          - match: about password
            reply: What password?!
          - match: fuck|shit|piss|crap|suck|idiot
            reply: You talk to your mother with that mouth?
            setStates:
              - sid angry

            # ----------- items -----------

    items:
    - name: desk
      description: The desk
      states:
        - name: default
          imageUrl: rooms/office-chest-closed.jpg
          short: A messy desk
          long:
            "A messy desk. There's a post it `note` with some letters scrawled on it. \n
            There's an antique looking `chest` under the desk. \n
            :mag: <https://cbg.rik.ai/rooms/office|click here to look around>"
      actions:
        - match: open
          pass:
            text: You open the drawers. Not much interesting stuff inside.

# ----------- note -----------

    - name: note
      description: A simple note
      states:
        - name: default
          short: There seem to be a sequence of letters
          imageUrl: items/note-sm.png
        - name: read
          short: "You've seen it before. The letters ATOV don't mean much"
          imageUrl: items/note-sm.png
      actions:
        - match: get|take
          pass:
            text: You pick up the note
            gets: note
            setHint: read-note
        - match: read|examine|inspect|look at
          needs: false
          reply: You read the note
          pass:
            text: "The note just has 4 letters on it: ATOV
              It seems like some kind of combination"
            imageUrl: items/note-sm.png
            gets: combination
            # name of the hint step
            setHint: open-lock
            # list of state changes: [state, item]
            # or just [state] for this item
            setStates:
              - read note

# ----------- chest -----------

    - name: chest
      description: A large treasure chest
      state: locked
      states:
        - name: locked
          short: A locked chest
          long: The chest is locked with an old fashioned looking combination lock.
          imageUrl: items/chest-closed.png
        - name: open
          short: the chest is open and you can see a large key inside
          imageUrl: items/chest-open-key.png
        - name: empty
          imageUrl: items/chest-open-empty.jpg
          short: A large chest. It's open, but you can't see anything inside.
      actions:
        - match: open|unlock
          needs: open-lock
          pass:
            text: You open up the chest, there's a key inside.
            setStates:
              - open chest
          fail:
            text: You try to open the chest, but there's an old combination lock on it.
        - match: get
          pass:
            text: It's too heavy to carry

    - name: lock
      description: A rusty combination lock
      state: locked
      # imageUrl: lock.gif
      states:
        - name: locked
          short: An unusual looking combination lock. It seems to use lettters rather than numbers.
          imageUrl: items/combolock-closed-sm.png
        - name: unlocked
          short: you opened the lock!
          imageUrl: items/combolock-open-sm.png
      actions:
        - match: open|ATOV|atov|unlock|use|open lock with code|open lock with atov
          needs: combination
          fail:
            text: You try to open the lock, but you don't know the combination
            hintStep: 3
          pass:
            text: you turn the dials to spell ATOV and it opens!
            gets: open-lock
            hintStep: 4
            setStates:
              - open chest
              - open lock
        - match: take
          needs: open-lock
          fail:
            text: It's locked to the chest
            hintStep: 3
          pass:
            text: you take the lock
            gets: open-lock

    - name: key
      description: An antique looking key
      states:
        - name: default
          short: ...
        - name: holding-key
          short: The key looks like it could open a door somewhere...
      actions:
        - match: get|take
          needs: open-lock
          pass:
            text: You take the key
            gets: key
          fail:
            text: You try to open the chest, but it's locked.

    - name: door
      description: A heavy door
      states:
        - name: locked
          short: The door is locked.
        - name: unlocked
          short: the door is unlocked.
      actions:
        - match: open
          needs: key
          fail:
            text: You try to open the door, but it's locked. If only you had a key...
          pass:
            text: You put the key in the door and it opens! You're free!
