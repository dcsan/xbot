name: office-hack
intro: You wake up in a strange room. The door is locked.
  You don't remember how you got in here but just know you have to get out!

rooms:
  - name: office
    description: A large empty room with a corner `desk`
    imageUrl: rooms/office-chest-closed.jpg
    caption: "<https://cbg.rik.ai/rooms/office| :mag: corner office>"
    hints:
      - 1. Have a `look` around for anything interesting!
      - 2. Try reading the note
      - 3. Does the note help you open the lock?
      - 4. What's inside the chest?
      - 5. Where could you use that key?
    actions:
      - match: atov/i
        pass:
          text: You say ATOV to noone in particular. Maybe you need to look for something else?

    items:
    - name: desk
      description: The desk
      states:
        - name: default
          imageUrl: rooms/office-chest-closed.jpg
          text:
            "A messy desk. There's a post it `note` with some letters scrawled on it. \n
            There's an antique looking `chest` under the desk. \n
            :mag: <https://cbg.rik.ai/rooms/office|click here to look around>"
      actions:
        - match: open
          pass:
            text: You open the drawers. Not much interesting stuff inside.

    - name: note
      description: A simple note
      states:
        - name: default
          text: There seem to be a sequence of letters
          imageUrl: items/note-sm.png
        - name: read
          text: "You've seen it before. The letters ATOV don't mean much"
          imageUrl: items/note-sm.png
      actions:
        - match: get|take
          pass:
            text: You pick up the note
            gets: note
            hintStep: 2
        - match: read|text
          needs: false
          pass:
            text: "The note just has 4 letters on it: ATOV
              It seems like some kind of combination"
            imageUrl: items/note-sm.png
            gets: combination
            hintStep: 3
            updates:
              - read note

    - name: chest
      description: A large treasure chest
      state: locked
      states:
        - name: locked
          text: The chest is locked
          imageUrl: items/chest-closed.png
        - name: open
          text: the chest is open and you can see a large key inside
          imageUrl: items/chest-open-key.png
        - name: empty
          imageUrl: items/chest-open-empty.jpg
          text: A large chest. It's open, but you can't see anything inside.
      actions:
        - match: open|unlock
          needs: open-lock
          pass:
            text: You open up the chest, there's a key inside.
            updates:
              - open chest
          fail:
            text: You try to open the chest, but there's an old combination lock on it.
        - match: get
          pass:
            text: It's too heavy to carry

    - name: lock
      description: A rusty combination lock
      state: locked
      # imageUrl: lock.gif
      states:
        - name: locked
          text: An unusual looking combination lock. It seems to use lettters rather than numbers.
          imageUrl: items/combolock-closed-sm.png
        - name: unlocked
          text: you opened the lock!
          imageUrl: items/combolock-open-sm.png
      actions:
        - match: open|ATOV|atov|unlock|use
          needs: combination
          fail:
            text: You try to open the lock, but you don't know the combination
            hintStep: 3
          pass:
            text: you turn the dials to spell ATOV and it opens!
            gets: open-lock
            hintStep: 4
            updates:
              - open chest
              - open lock
        - match: take
          needs: open-lock
          fail:
            text: It's locked to the chest
            hintStep: 3
          pass:
            text: you take the lock
            gets: open-lock

    - name: key
      description: An antique looking key
      states:
        - name: default
          text: ...
        - name: holding-key
          text: The key looks like it could open a door somewhere...
      actions:
        - match: open door with key|open door
          needs: key
          pass:
            text: You open up the chest, there's a key inside.
          fail:
            text: You try to open the chest, but it's locked.
        - match: get|take
          needs: open-chest
          pass:
            text: You take the key
            gets: key
          fail:
            text: You try to open the chest, but it's locked.

    - name: door
      description: A heavy door
      states:
        - name: locked
          text: The door is locked.
        - name: unlocked
          text: the door is unlocked.

      text: The lock is creaking
      actions:
        - match: open
          needs: key
          fail:
            text: You try to open the door, but it's locked. If only you had a key...
          pass:
            text: You put the key in the door and it opens! You're free!
